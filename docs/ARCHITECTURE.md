# ๐๏ธ ะััะธัะตะบัััะฐ CurRate-Go

> **ะะตัะฐะปัะฝะพะต ะพะฟะธัะฐะฝะธะต ะฐััะธัะตะบัััั ัะธััะตะผั**

---

## ะะฑะทะพั ะฐััะธัะตะบัััั

CurRate-Go ะฟะพัััะพะตะฝ ะฝะฐ ะผะฝะพะณะพัะปะพะนะฝะพะน ะฐััะธัะตะบัััะต ั ัะตัะบะธะผ ัะฐะทะดะตะปะตะฝะธะตะผ ะพัะฒะตัััะฒะตะฝะฝะพััะธ ะผะตะถะดั ัะปะพัะผะธ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     GUI Layer (Wails)                   โ
โ           HTML/CSS/JS โ Go Backend (App.go)             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
                            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  Business Logic Layer                   โ
โ                                                         โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ โ
โ  โ  Converter   โ  โ  Validator   โ  โ  Formatter   โ โ
โ  โ  (ะณะปะฐะฒะฝะฐั    โ  โ  (ะฟัะพะฒะตัะบะฐ   โ  โ  (ะฒัะฒะพะด      โ โ
โ  โ   ะปะพะณะธะบะฐ)    โ  โ   ะดะฐะฝะฝัั)    โ  โ  ัะตะทัะปััะฐัะฐ) โ โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
            โโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโ
            โผ                               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   Data Access Layer     โ   โ   Caching Layer         โ
โ                         โ   โ                         โ
โ  โโโโโโโโโโโโโโโโโโโโ   โ   โ  โโโโโโโโโโโโโโโโโโโโ  โ
โ  โ  Parser (XML)    โ   โ   โ  โ   LRU Cache      โ  โ
โ  โ  โข ParseXML      โ   โ   โ  โ   โข 100 items    โ  โ
โ  โ  โข FetchRates    โ   โ   โ  โ   โข TTL 24h      โ  โ
โ  โ  โข HTTP Client   โ   โ   โ  โ   โข Thread-safe  โ  โ
โ  โโโโโโโโโโโโโโโโโโโโ   โ   โ  โโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              CBR XML API (ะฆะ ะะค)                        โ
โ    https://www.cbr.ru/scripts/XML_daily.asp             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ะกะปะพะธ ะฐััะธัะตะบัััั

### 1. GUI Layer (Wails)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะพะปัะทะพะฒะฐัะตะปััะบะธะน ะธะฝัะตััะตะนั ะธ ะฒะทะฐะธะผะพะดะตะนััะฒะธะต ั ะฟะพะปัะทะพะฒะฐัะตะปะตะผ

**ะขะตัะฝะพะปะพะณะธะธ:**
- **Wails v2.11.0** - Desktop UI ััะตะนะผะฒะพัะบ
- **WebView2** - ะะฐัะธะฒะฝัะน ัะตะฝะดะตัะธะฝะณ (Windows 11)
- **HTML/CSS/Vanilla JavaScript** - Frontend ะฑะตะท ััะตะนะผะฒะพัะบะพะฒ

**ะะพะผะฟะพะฝะตะฝัั:**
- `frontend/index.html` - ะัะฝะพะฒะฝะฐั ัะฐะทะผะตัะบะฐ
- `frontend/styles/` - ะกัะธะปะธ CSS
- `frontend/scripts/` - JavaScript ะปะพะณะธะบะฐ
- `main_gui.go` - ะขะพัะบะฐ ะฒัะพะดะฐ ะดะปั GUI
- `internal/app/app.go` - Go backend ะดะปั Wails bindings

**ะะทะฐะธะผะพะดะตะนััะฒะธะต:**
- Frontend ะฒัะทัะฒะฐะตั ะผะตัะพะดั Go ัะตัะตะท Wails Runtime
- Go backend ะพะฑัะฐะฑะฐััะฒะฐะตั ะทะฐะฟัะพัั ะธ ะฒะพะทะฒัะฐัะฐะตั ัะตะทัะปััะฐัั
- ะะฒัััะพัะพะฝะฝัั ัะฒัะทั ัะตัะตะท ัะพะฑััะธั

---

### 2. Business Logic Layer

**ะะฐะทะฝะฐัะตะฝะธะต:** ะัะฝะพะฒะฝะฐั ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ ะบะพะฝะฒะตััะฐัะธะธ ะฒะฐะปัั

**ะะพะดัะปะธ:**

#### Converter (`internal/converter/converter.go`)
- ะะปะฐะฒะฝัะน ะบะพะฝะฒะตััะตั ะฒะฐะปัั
- ะะพะพัะดะธะฝะฐัะธั ัะฐะฑะพัั ะฒัะตั ะบะพะผะฟะพะฝะตะฝัะพะฒ
- ะะฑัะฐะฑะพัะบะฐ ัะตะทัะปััะฐัะพะฒ ะบะพะฝะฒะตััะฐัะธะธ

#### Validator (`internal/converter/validator.go`)
- ะะฐะปะธะดะฐัะธั ะฒัะพะดะฝัั ะดะฐะฝะฝัั
- ะัะพะฒะตัะบะฐ ะบะพััะตะบัะฝะพััะธ ััะผะผั ะธ ะดะฐัั
- ะะฐะปะธะดะฐัะธั ะฒะฐะปััั

#### Formatter (`internal/converter/formatter.go`)
- ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะฐ ะบะพะฝะฒะตััะฐัะธะธ
- ะะพะดะดะตัะถะบะฐ ััััะบะพะณะพ ัะพัะผะฐัะฐ ัะธัะตะป
- ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะฒะฐะปัั

**ะะทะฐะธะผะพะดะตะนััะฒะธะต:**
- Converter ะธัะฟะพะปัะทัะตั Validator ะดะปั ะฟัะพะฒะตัะบะธ ะฒัะพะดะฝัั ะดะฐะฝะฝัั
- Converter ะธัะฟะพะปัะทัะตั Formatter ะดะปั ัะพัะผะฐัะธัะพะฒะฐะฝะธั ัะตะทัะปััะฐัะฐ
- Converter ะฒะทะฐะธะผะพะดะตะนััะฒัะตั ั Data Access Layer ะดะปั ะฟะพะปััะตะฝะธั ะบัััะพะฒ

---

### 3. Data Access Layer

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั ะพ ะบัััะฐั ะฒะฐะปัั ะธะท ะฒะฝะตัะฝะธั ะธััะพัะฝะธะบะพะฒ

**ะะพะดัะปะธ:**

#### Parser (`internal/parser/`)
- **xml.go** - XML ะฟะฐััะตั ั ะฟะพะดะดะตัะถะบะพะน windows-1251
- **client.go** - HTTP ะบะปะธะตะฝั ั retry ะปะพะณะธะบะพะน
- **cbr.go** - ะัะฑะปะธัะฝัะน API ะดะปั ะฟะพะปััะตะฝะธั ะบัััะพะฒ

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะะพะดะดะตัะถะบะฐ ะบะพะดะธัะพะฒะบะธ windows-1251 (ะบะพะฝะฒะตััะฐัะธั ะฒ UTF-8)
- Exponential backoff retry (1s, 2s, 4s)
- ะะฑัะฐะฑะพัะบะฐ HTTP ัะตะดะธัะตะบัะพะฒ
- ะขะฐะนะผะฐััั ะธ ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

**ะะทะฐะธะผะพะดะตะนััะฒะธะต:**
- ะะพะปััะฐะตั ะดะฐะฝะฝัะต ะธะท CBR XML API
- ะะพะทะฒัะฐัะฐะตั ััััะบัััะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต ะฒ Business Logic Layer
- ะะ ะทะฐะฝะธะผะฐะตััั ะบััะธัะพะฒะฐะฝะธะตะผ (ััะพ ะพัะฒะตัััะฒะตะฝะฝะพััั Converter)

---

### 4. Caching Layer

**ะะฐะทะฝะฐัะตะฝะธะต:** ะััะธัะพะฒะฐะฝะธะต ะบัััะพะฒ ะฒะฐะปัั ะดะปั ะผะธะฝะธะผะธะทะฐัะธะธ ะทะฐะฟัะพัะพะฒ ะบ API

**ะะพะดัะปั:** `internal/cache/`

**ะัะพะฑะตะฝะฝะพััะธ:**
- **LRU (Least Recently Used)** ะฐะปะณะพัะธัะผ
- **TTL (Time To Live)** - 24 ัะฐัะฐ
- **Thread-safe** - ะฑะตะทะพะฟะฐัะตะฝ ะดะปั concurrent ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- **100 items** - ะผะฐะบัะธะผะฐะปัะฝัะน ัะฐะทะผะตั ะบััะฐ

**ะะทะฐะธะผะพะดะตะนััะฒะธะต:**
- ะัั ะธัะฟะพะปัะทัะตััั Business Logic Layer (Converter) ะดะปั ััะฐะฝะตะฝะธั ะบัััะพะฒ
- Converter ะฟัะพะฒะตััะตั ะบัั ะฟะตัะตะด ะทะฐะฟัะพัะพะผ ะบ Parser
- Converter ัะพััะฐะฝัะตั ะฟะพะปััะตะฝะฝัะต ะบัััั ะฒ ะบัั
- ะะฒัะพะผะฐัะธัะตัะบะธ ะธะฝะฒะฐะปะธะดะธััะตั ัััะฐัะตะฒัะธะต ะทะฐะฟะธัะธ ะฟะพ TTL

---

## ะกัััะบัััะฐ ะผะพะดัะปะตะน

```
internal/
โโโ models/         # ะะพะดะตะปะธ ะดะฐะฝะฝัั (Currency, ExchangeRate, RateData)
โโโ parser/         # ะะฐััะธะฝะณ XML API ะฆะ ะะค
โ   โโโ xml.go      # XML ะฟะฐััะตั (encoding/xml + windows-1251)
โ   โโโ parser.go   # ะะฑัะธะต ััะฝะบัะธะธ ะฟะฐััะธะฝะณะฐ
โ   โโโ client.go   # HTTP ะบะปะธะตะฝั ั retry
โ   โโโ cbr.go      # ะัะฑะปะธัะฝัะน API
โโโ cache/          # LRU ะบัั ั TTL
โโโ converter/      # ะะธะทะฝะตั-ะปะพะณะธะบะฐ ะบะพะฝะฒะตััะฐัะธะธ
โ   โโโ converter.go    # ะะปะฐะฒะฝัะน ะบะพะฝะฒะตััะตั
โ   โโโ validator.go    # ะะฐะปะธะดะฐัะธั ะฒัะพะดะฝัั ะดะฐะฝะฝัั
โ   โโโ formatter.go    # ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะฐ
โโโ telegram/       # ะะฝัะตะณัะฐัะธั ั Telegram Bot API
โ   โโโ telegram.go     # ะัะฟัะฐะฒะบะฐ ัะฒะตะดะพะผะปะตะฝะธะน
โ   โโโ userid.go       # ะะตะฝะตัะฐัะธั ะฐะฝะพะฝะธะผะฝะพะณะพ user ID
โโโ app/            # Wails backend (App.go)
```

---

## ะะพัะพะบะธ ะดะฐะฝะฝัั

### ะะพะฝะฒะตััะฐัะธั ะฒะฐะปัั (GUI)

1. **ะะพะปัะทะพะฒะฐัะตะปั ะฒะฒะพะดะธั ะดะฐะฝะฝัะต** ะฒ GUI (ััะผะผะฐ, ะฒะฐะปััะฐ, ะดะฐัะฐ)
2. **Frontend ะฒัะทัะฒะฐะตั Go ะผะตัะพะด** ัะตัะตะท Wails Runtime
3. **App.go ะฟะพะปััะฐะตั ะทะฐะฟัะพั** ะธ ะฟะตัะตะดะฐะตั ะฒ Converter
4. **Converter ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต** ัะตัะตะท Validator
5. **Converter ะฟัะพะฒะตััะตั ะบัั** - ะตัะปะธ ะบััั ะตััั, ะธัะฟะพะปัะทัะตั ะตะณะพ
6. **ะัะปะธ ะบัั ะฟััั**, Converter ะทะฐะฟัะฐัะธะฒะฐะตั ะดะฐะฝะฝัะต ัะตัะตะท Parser
7. **Parser ะดะตะปะฐะตั HTTP ะทะฐะฟัะพั** ะบ CBR XML API
8. **Parser ะฟะฐััะธั XML** ะธ ะฒะพะทะฒัะฐัะฐะตั ััััะบัััะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต
9. **Converter ัะพััะฐะฝัะตั ะฟะพะปััะตะฝะฝัะน ะบััั** ะฒ ะบัั ะดะปั ะฟะพัะปะตะดัััะธั ะทะฐะฟัะพัะพะฒ
10. **Converter ะบะพะฝะฒะตััะธััะตั ะฒะฐะปััั** ะธัะฟะพะปัะทัั ะฟะพะปััะตะฝะฝัะน ะบััั
11. **Formatter ัะพัะผะฐัะธััะตั ัะตะทัะปััะฐั** ะดะปั ะพัะพะฑัะฐะถะตะฝะธั
12. **ะะตะทัะปััะฐั ะฒะพะทะฒัะฐัะฐะตััั** ะฒ Frontend ัะตัะตะท Wails Runtime
13. **GUI ะพัะพะฑัะฐะถะฐะตั ัะตะทัะปััะฐั** ะฟะพะปัะทะพะฒะฐัะตะปั

### ะะพะฝะฒะตััะฐัะธั ะฒะฐะปัั (API)

1. **ะัะทะพะฒ API ะผะตัะพะดะฐ** Converter.Convert()
2. **Converter ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต** ัะตัะตะท Validator
3. **Converter ะฟัะพะฒะตััะตั ะบัั** - ะตัะปะธ ะบััั ะตััั, ะธัะฟะพะปัะทัะตั ะตะณะพ
4. **ะัะปะธ ะบัั ะฟััั**, Converter ะทะฐะฟัะฐัะธะฒะฐะตั ะดะฐะฝะฝัะต ัะตัะตะท Parser
5. **Parser ะฟะพะปััะฐะตั ะดะฐะฝะฝัะต** ะธะท CBR XML API
6. **Converter ัะพััะฐะฝัะตั ะฟะพะปััะตะฝะฝัะน ะบััั** ะฒ ะบัั
7. **Converter ะบะพะฝะฒะตััะธััะตั** ะธ ัะพัะผะฐัะธััะตั ัะตะทัะปััะฐั
8. **ะะตะทัะปััะฐั ะฒะพะทะฒัะฐัะฐะตััั** ะฒัะทัะฒะฐััะตะผั ะบะพะดั

---

## ะัะธะฝัะธะฟั ะฟัะพะตะบัะธัะพะฒะฐะฝะธั

### 1. Separation of Concerns
- ะะฐะถะดัะน ัะปะพะน ะธะผะตะตั ัะตัะบัั ะพัะฒะตัััะฒะตะฝะฝะพััั
- ะะธะฝะธะผะฐะปัะฝะฐั ัะฒัะทะฐะฝะฝะพััั ะผะตะถะดั ัะปะพัะผะธ
- ะััะพะบะฐั ัะฟะปะพัะตะฝะฝะพััั ะฒะฝัััะธ ัะปะพะตะฒ

### 2. Dependency Injection
- Converter ะฟะพะปััะฐะตั ะทะฐะฒะธัะธะผะพััะธ ัะตัะตะท ะบะพะฝััััะบัะพั
- ะะตะณะบะพ ัะตััะธัะพะฒะฐัั ะธ ะผะพะบะธัะพะฒะฐัั
- ะะธะฑะบะพััั ะฒ ะทะฐะผะตะฝะต ะบะพะผะฟะพะฝะตะฝัะพะฒ

### 3. Interface-based Design
- ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะธะฝัะตััะตะนัะพะฒ ะดะปั ะฐะฑัััะฐะบัะธะธ
- ะะตะณะบะฐั ะทะฐะผะตะฝะฐ ัะตะฐะปะธะทะฐัะธะน
- ะฃะฟัะพัะตะฝะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต

### 4. Error Handling
- ะฏะฒะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- ะะพะฝััะฝัะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
- Graceful degradation

---

## ะกะฒัะทะฐะฝะฝัะต ะดะพะบัะผะตะฝัั

- **[03-ะะะฅะะขะะะขะฃะะะซะ-ะะะะะะ.md](03-ะะะฅะะขะะะขะฃะะะซะ-ะะะะะะ.md)** - ะะตัะฐะปัะฝัะน ะฐััะธัะตะบัััะฝัะน ะดะธะทะฐะนะฝ
- **[12-WAILS-GUI-ะะะฅะะขะะะขะฃะะ.md](12-WAILS-GUI-ะะะฅะะขะะะขะฃะะ.md)** - ะััะธัะตะบัััะฐ GUI ะบะพะผะฟะพะฝะตะฝัะฐ
- **[README.md](../README.md)** - ะะฑะทะพั ะฟัะพะตะบัะฐ

---

<div align="center">

[โฌ ะะฐะฒะตัั](#-ะฐััะธัะตะบัััะฐ-currate-go)

</div>

